# Medical Schedule Application

Система за записване на часове при лекари с Bootstrap и Supabase. Приложението позволява на потребителите да разглеждат графици на лекари, да се регистрират като лекари или пациенти, и да записват часове.

## Функционалности

### 1. Публични функции (без регистрация)
- ✅ Преглед на списък с всички регистрирани лекари
- ✅ Избор на лекар и преглед на неговия график
- ✅ Календар показващ свободни и заети часове за всеки лекар

### 2. Регистрация и вход
- ✅ Регистрация като лекар (име, специалност, email, парола, работни часове)
- ✅ Регистрация като пациент (име, телефон, email, парола)
- ✅ Вход в системата за регистрирани потребители

### 3. Функции за лекари
- ✅ Автоматично добавяне в списъка след регистрация
- ✅ Задаване на работни часове
- ✅ Преглед на графиците на всички лекари
- ✅ Качване на профилна снимка (аватар)
- ✅ Преглед на детайли за собствения си график, както и име на пациента и оплакванията му за всеки записан час
- ✅ Избор на тема на приложението (светла/тъмна) от Settings
- ✅ Подаване на заявка за администраторски достъп (изисква одобрение)

### 4. Функции за пациенти
- ✅ Преглед на графици на всички лекари
- ✅ Избор на лекар и свободен час
- ✅ Записване на час с описание на оплакванията
- ✅ Преглед на собствените записани часове
- ✅ Избор на тема на приложението (светла/тъмна) от Settings

### 5. Функции за администратори

В приложението има имплементирани **администратори** със специални права. Админ достъпът се активира за потребител (по email) чрез запис в таблица `admins` (и `is_active = true`).

Администраторите имат достъп до **Администраторски панел** (от Home → потребителския панел), който включва:
- ✅ Управление на лекари: преглед на всички лекари + изтриване
- ✅ Управление на пациенти: преглед на всички пациенти + изтриване
- ✅ Управление на записани часове: преглед на всички записи + изтриване
- ✅ Управление на заявки за админ: одобрение/отказ на заявки (таблица `admin_requests`)

## Структура на проекта

```
src/
├── pages/           # Страници (home, schedule, doctors, settings)
├── components/      # Преизползваеми UI компоненти
├── services/        # Бизнес логика (auth, router, supabase)
├── utils/           # Помощни функции
├── styles/          # CSS стилове
└── assets/          # Изображения и ресурси
```

## Технологии

- **Frontend**: HTML5, CSS3, Vanilla JavaScript (ES6+)
- **Build Tool**: Vite
- **UI Framework**: Bootstrap 5
- **Backend**: Supabase (PostgreSQL, Authentication)
- **Package Manager**: npm
- **Node.js**: v16+

## Инструкции за настройка

### 1. Инсталиране на зависимости

```bash
npm install
```

### 2. Конфигуриране на Supabase

1. Създайте проект на [supabase.com](https://supabase.com)
2. Копирайте вашия Supabase URL и Anonymous Key
3. Създайте `.env` файл в root директорията на проекта:

```bash
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 3. Настройка на базата данни

Вижте подробни инструкции в [DATABASE_SETUP.md](DATABASE_SETUP.md) за:
- SQL скриптове за създаване на таблици
- Row Level Security (RLS) политики
- Тестови данни

### 4. Стартиране на development сървър

```bash
npm run dev
```

## База данни схема

### Таблица: doctors
- `id` - UUID (primary key)
- `name` - Име на лекаря
- `specialty` - Специалност
- `email` - Email (unique)
- `work_hours_from` - Начало на работния ден
- `work_hours_to` - Край на работния ден

### Таблица: patients
- `id` - UUID (primary key)
- `name` - Име на пациента
- `phone` - Телефон
- `email` - Email (unique)

### Таблица: appointments
- `id` - UUID (primary key)
- `doctor_id` - Референция към лекар
- `patient_id` - Референция към пациент
- `appointment_date` - Дата на прегледа
- `appointment_time` - Час на прегледа
- `complaints` - Оплаквания на пациента
- `status` - Статус (scheduled, completed, cancelled)

## Как да използвате приложението

### За посетители (без регистрация):
1. Отворете началната страница
2. Вляво ще видите списък с лекари
3. Кликнете на лекар за да видите неговия график
4. Календарът показва свободни (зелени) и заети (червени) часове

Съвет: Ако приложението няма връзка към Supabase (липсва/грешен URL/Key), отидете в **Settings** страницата и проверете конфигурацията.

### За регистрация като лекар:
1. Натиснете "Регистрация като лекар"
2. Попълнете формата с вашите данни
3. Задайте работни часове
4. След регистрация ще се появите в списъка с лекари

### За регистрация като пациент:
1. Натиснете "Регистрация като пациент"
2. Попълнете формата с вашите данни
3. След вход можете да записвате часове

### За записване на час (като пациент):
1. Влезте в системата
2. Изберете лекар от списъка
3. Прегледайте календара
4. Кликнете на свободен час (зелен)
5. Опишете оплакванията си
6. Потвърдете записа

## Build за production

```bash
npm run build
```

Файловете ще бъдат генерирани в `dist/` директорията.

## Deploy в Netlify

Проектът е Vite SPA (History API routing), и вече има Netlify настройки в `netlify.toml` + `public/_redirects`.

1. Качете проекта в Git (GitHub/GitLab).
2. Netlify → **Add new site** → **Import from Git**.
3. Build settings (ако не се попълнят автоматично):
	- **Build command:** `npm run build`
	- **Publish directory:** `dist`
4. Netlify → **Site settings → Environment variables** добавете (преди deploy / или направете redeploy след добавяне):
	- `VITE_SUPABASE_URL`
	- `VITE_SUPABASE_ANON_KEY`

Забележка: Vite “вгражда” env променливите по време на build, т.е. промени в env изискват нов deploy.

Ако използвате email confirmation при регистрация: в Supabase → Authentication settings добавете Netlify домейна ви като Site URL/Redirect URL (за да може линкът от имейла да връща към сайта).

## Превю на production build

```bash
npm run preview
```

Приложението ще се отвори на `http://localhost:5173`

## Build за production (обобщение)

```bash
npm run build
```

Готовите файлове ще бъдат в директорията `dist/`.

## Функционалности (обобщение)

- **Навигация между страници**: Hash-базирано routing решение със страници (pages)
- **Responsive дизайн**: Mobile-friendly UI с Bootstrap
- **Модулна архитектура**: Разделение по отговорности (pages, services, components)
- **Supabase интеграция**: База данни + Authentication
- **Лекари**: Преглед и управление на лекари
- **Графици**: Преглед на свободни/заети часове
- **Settings**: Конфигурация на Supabase credentials
- **Администратори**: Админ панел за управление на лекари/пациенти/часове + одобрение на заявки за админ

## Навигация

- **Home** (`#home`) - Начална страница
- **Schedule** (`#schedule`) - График на лекарите
- **Doctors** (`#doctors`) - Списък с лекари
- **Settings** (`#settings`) - Настройки на приложението

## Идеи за бъдещо развитие

- [ ] По-строга валидация на формите и по-ясни съобщения за грешки
- [ ] Нотификации (напр. имейл/вътрешни известия) за записани/отменени часове
- [ ] Експорт/принт на график/часове

## Contributing

This project is set up for AI-assisted development. Feel free to extend and customize as needed.

## License

MIT
